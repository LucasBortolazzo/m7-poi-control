<main>
    <div class="content-form">
        <mat-expansion-panel #MatExpansionPanelFiltro [expanded]="true">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>Poi Control</strong>
                </mat-panel-title>
                <mat-panel-description> Filtros </mat-panel-description>
            </mat-expansion-panel-header>

            <p class="welcome">
                Ola ðŸ‘‹. Seja bem vindo ao <strong><i>Poi Control</i> </strong>. Para visualizar informacoes especificas
                utilize
                os filtros abaixo:
            </p>

            <form [formGroup]="formFiltro">
                <section class="fields">
                    <mat-form-field appearance="outline">
                        <mat-label>Ponto de interesse</mat-label>
                        <mat-select formControlName="poiId" name="poiId">
                            <mat-option *ngFor="let poi of pois" [value]="poi.id"> {{ poi.id }} - {{ poi.nome }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Placa</mat-label>
                        <mat-select formControlName="placa" name="placa">
                            <mat-option *ngFor="let placa of placas" [value]="placa">
                                {{ placa }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                        <mat-label>Data da leitura</mat-label>
                        <input matInput [matDatepicker]="picker" placeholder="Data da leitura"
                            aria-label="Data da leitura" formControlName="dataLeitura" />
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                </section>

                <div class="buttons">
                    <button mat-button color="primary" (click)="redefinirFiltros()">Redefinir filtros</button>
                    <button mat-flat-button color="primary" (click)="visualizarPois()">Visualizar</button>
                </div>
            </form>

            <div class="card-overlay" *ngIf="loading">
                <mat-spinner strokeWidth="2" diameter="50"></mat-spinner>
            </div>
        </mat-expansion-panel>
    </div>

    <!-- Map container -->
    <div id="map"></div>

    <!-- Tabela de totalizados do POI -->
    <div class="poi-table">
        <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <strong>Resumo dos POI's</strong>
                </mat-panel-title>
                <mat-panel-description>

                </mat-panel-description>
            </mat-expansion-panel-header>


            <table mat-table [dataSource]="dataPoiTable" *ngIf="dataPoiTable.length > 0" class="mat-elevation-z8">
                <!-- Position Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef>ID POI</th>
                    <td mat-cell *matCellDef="let element">{{ element.id }}</td>
                </ng-container>

                <!-- Name Column -->
                <ng-container matColumnDef="nome">
                    <th mat-header-cell *matHeaderCellDef>Nome</th>
                    <td mat-cell *matCellDef="let element">{{ element.nome }}</td>
                </ng-container>

                <!-- Weight Column -->
                <ng-container matColumnDef="latitude">
                    <th mat-header-cell *matHeaderCellDef>Latitude</th>
                    <td mat-cell *matCellDef="let element">{{ element.latitude }}</td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="longitude">
                    <th mat-header-cell *matHeaderCellDef>Longitude</th>
                    <td mat-cell *matCellDef="let element">{{ element.longitude }}</td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="raio">
                    <th mat-header-cell *matHeaderCellDef>Raio em metros</th>
                    <td mat-cell *matCellDef="let element">{{ element.raio }}</td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="veiculos">
                    <th mat-header-cell *matHeaderCellDef>Veiculos distintos no POI</th>
                    <td mat-cell *matCellDef="let element">{{ element.veiculos.length }}</td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="totalizadorPoi">
                    <th mat-header-cell *matHeaderCellDef>Tempo total dos veiculos no POI</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.totalizadorPoi.tempo_total_dia_veiculos }} dia(s),
                        {{ element.totalizadorPoi.tempo_total_hora_veiculos }} hora(s) e
                        {{ element.totalizadorPoi.tempo_total_minuto_veiculos }} minuto(s)
                    </td>
                </ng-container>

                <ng-container matColumnDef="verNoMapa">
                    <th mat-header-cell *matHeaderCellDef>Posicionar no mapa</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-mini-fab color="primary" (click)="abrirLocalizacaoMapa(element)">
                            <mat-icon>my_location</mat-icon>
                        </button>
                    </td>
                </ng-container>

                <ng-container matColumnDef="verDadosCalculo">
                    <th mat-header-cell *matHeaderCellDef>MemÃ³ria de calculo</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-mini-fab color="accent" (click)="abrirDialogMemoriaCalculo(element)">
                            <mat-icon>restore</mat-icon>
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
        </mat-expansion-panel>
    </div>
</main>